
\section{Metody uczenia maszynowego do analizy EKG}

\subsection{Rozpoznawanie arytmii}
ZROBIÆ JAKIS WSTÊP, ABY NIE DENERWOWAC PIOTRA.

Do rozpoznawania arytmii wykorzystuje siê szeroki zakres metod uczenia
maszynowego, obejmuj¹cych zarówno klasyczne podejœcia uczenia nadzorowanego,
jak i techniki uczenia nienadzorowanego. Wœród klasycznych algorytmów
nadzorowanych popularne s¹ SVM (Support Vector Machines), KNN (K-Nearest
Neighbors), klasyfikatory Bayesowskie, drzewa decyzyjne oraz lasy losowe.
Metody uczenia nienadzorowanego równie¿ odgrywaj¹ istotn¹ rolê, wspieraj¹c
proces eksploracji danych i in¿ynierii cech, co mo¿e znacz¹co poprawiæ
skutecznoœæ modeli klasyfikacyjnych. W tym zakresie stosuje siê algorytmy takie
jak K-means, fuzzy c-means clustering, grupowanie hierarchiczne oraz Gaussian
Mixture Models. Ponadto coraz czêœciej wykorzystuje siê g³êbokie sieci
neuronowe, niewymagaj¹ce w tym splotowe sieci neuronowe (CNN) oraz sieci LSTM
(Long Short-Term Memory) \cite{Kavya-shockableArthytmiaDetection}.

Ribeiro i wspó³autorzy \cite{ribeiro2020automatic} opracowali g³êbok¹ sieæ
neuronow¹ (DNN) do automatycznej klasyfikacji nieprawid³owoœci w krótkotrwa³ych
(7-10 s), 12-odprowadzeniowych zapisach EKG. Algorytm zosta³ wytrenowany na
zbiorze danych obejmuj¹cym ponad 2,3 miliona zapisów EKG. Architektura DNN
opiera³a siê na sieci rezydualnej przystosowanej do analizy sygna³ów
jednowymiarowych, z warstwami konwolucyjnymi i po³¹czeniami skip dla
zwiêkszenia efektywnoœci treningu.

DNN zosta³a wytrenowana do wykrywania szeœciu nieprawid³owoœci: bloku
przedsionkowo-komorowego I stopnia, bloku prawej odnogi pêczka Hisa, bloku
lewej odnogi pêczka Hisa, bradykardii zatokowej, migotania przedsionków oraz
tachykardii zatokowej. Model osi¹gn¹³ wysokie wyniki F1 (powy¿ej 80\%) oraz
specyficznoœæ (>99\%) dla ka¿dej z klas, dorównuj¹c lub przewy¿szaj¹c wydajnoœæ
rezydentów kardiologii i studentów medycyny.

Praca pokazuje potencja³ DNN do nauki end-to-end, gdzie klasyfikacja odbywa siê
bezpoœrednio na podstawie surowych sygna³ów EKG, bez koniecznoœci rêcznego
wyodrêbniania cech. Podkreœlono równie¿ znaczenie du¿ych, odpowiednio
oznaczonych zbiorów danych dla trenowania modeli oraz korzyœci wynikaj¹ce z
zastosowania g³êbokiego uczenia w dok³adnej i skalowalnej interpretacji EKG w
praktyce klinicznej, zw³aszcza na obszarach z ograniczonym dostêpem do
specjalistów. \\

Metodê klasyfikacji, nie opart¹ o sieci neuronowe przedstawiono w publikacji
\cite{Morteza-RandomForest}. Autorzy zaproponowali hybrydowy algorytm,
umo¿liwiaj¹cy przypisanie sygna³u do jednej z czterech klas: migotania
przedsionków (AF), normalnego rytmu zatokowego, innych rytmów lub sygna³ów zbyt
zak³óconych do analizy. Proces ten opiera³ siê na wykorzystaniu klasyfikatora
opartego o las losowy (Random Forest) zarówno do selekcji cech, jak i do
finalnej klasyfikacji, co pozwoli³o na efektywne przetwarzanie i analizê du¿ej
liczby parametrów.

W pocz¹tkowej fazie sygna³ EKG by³ poddawany wstêpnemu przetworzeniu,
obejmuj¹cego odszumianie i usuniêcie przesuniêcia bazowego. Nastêpnie
wyodrêbniono 491 cech opisuj¹cych w³aœciwoœci sygna³u w domenach czasowej,
czêstotliwoœciowej, czasowo-czêstotliwoœciowej oraz przestrzeni fazowej.
Kolejnym etapem by³o wy³onienie najistotniejszych cech, którê zosta³o
przeprowadzone za pomoc¹ Random Forest, na podstawie oceny ich wp³ywu na
zmniejszanie entropii w modelu. W ten sposób uzyskano zbiór 150 najbardziej
znacz¹cych cech.

Ostateczna klasyfikacja odbywa³a siê równie¿ za pomoc¹ Random Forest z 500
drzewami decyzyjnymi, z wykorzystaniem techniki baggingu oraz losowego wyboru
cech w wêz³ach, co zwiêksza³o odpornoœæ na przeuczenie i poprawia³o stabilnoœæ
predykcji. Algorytm osi¹gn¹³ skutecznoœæ 82,6\% na niezale¿nym zbiorze
testowym, co zapewni³o mu ex aequo pierwsze miejsce w PhysioNet/Computing in
Cardiology Challenge 2017
\cite{Morteza-RandomForest}\cite{PhysioNet-Challange2017}.

\subsection{Wykrywanie sczytów R}
Wykrywanie szczytów R w sygnale EKG to kluczowy etap analizy, na podstawie
którego obliczane s¹ istotne parametry pracy serca. Tradycyjne metody, takie
jak algorytm Pan-Tompkins, mimo swojej popularnoœci, czêsto okazuj¹ siê podatne
na szumy i zak³ócenia w sygnale, co ogranicza ich skutecznoœæ w trudnych
warunkach. W odpowiedzi na te wyzwania coraz czêœciej stosuje siê metody
uczenia maszynowego, takie jak splotowe sieci neuronowe (CNN) czy sieci LSTM
(Long Short-Term Memory), które s¹ bardziej odporne na zak³ócenia i lepiej
radz¹ sobie z analiz¹ z³o¿onych wzorców sygna³u.

Przyk³ad zastosowania sieci LSTM w detekcji szczytów R przedstawiono w pracy
\cite{JUHO-LSTM}. Zaprezentowany model sk³ada³ siê z dwóch warstw
dwukierunkowych LSTM, które wykorzystywa³y tangens hiperboliczny jako funkcje
aktywacji oraz warstwy gêstej z funkcj¹ sigmoid, generuj¹c¹ prawdopodobieñstwo,
¿e dany punkt w czasie to szczyt R. Do trenowania wykorzystano zbiór danych
MIT-BIH Arrhythmia Database oraz MIT-BIH Noise Stress Test Database,
rozszerzaj¹c zbiór danych poprzez dodawanie realistycznych zak³óceñ, takich jak
dryf linii bazowej czy artefakty miêœniowe. Model by³ trenowany z u¿yciem
optymalizatora Adam i funkcji strat binarnej entropii krzy¿owej, na ponad 1,5
miliona przyk³adów.

Po odpowiednim odfiltrowaniu punktów o niskim prawdopodobieñswie, podejœcie
LSTM osi¹gnê³o wysokie wyniki, osi¹gaj¹c wyniik F1 na poziomie znacznie powy¿ej
0.90, nawet przy niskim stosunku sygna³u do szumu (SNR 0.1). Zaproponowane
rozwi¹zanie wykaza³o sie lepszymi rezultatami ni¿ tradycyjne metody nie
korzystaj¹ce z dorobku uczenia maszynowego (Hamilton, Christov, Engzee,
Pan-Tomkins). Autorzy wskazali plany na rozwiniêcie owej architektury do modelu
end-to-end.

W pracy \cite{MUzairZahid-UNET} autorzy przedstawili model wykorzystuj¹cy
jednowymiarowe sieci splotowe, o architekturze UNet. Rozwi¹zanie bazowa³o na
strukturze kodera-dekodera z po³¹czeniami typu skip connections. Model sk³ada³
siê z szeœciu warstw kodera, odpowiedzialnych za ekstrakcjê cech sygna³u EKG za
pomoc¹ konwolucji i downsamplingu, oraz szeœciu warstw dekodera, które
rekonstruowa³y cechy przy u¿yciu odwrotnej konwolucji i upsamplingu. Po³¹czenia
skip miêdzy odpowiadaj¹cymi sobie warstwami kodera i dekodera pozwala³y na
efektywne przenoszenie informacji pomiêdzy warstwami. Do trenowania sieci u¿yto
takich zbiorów danych jak MIT-BIH oraz China Physiological Signal Challenge
2020 database (CPSC-DB), które równie¿ celowo zaszumiano, dodaj¹c do nich dryf
linii bazowej oraz zak³ócenia ruchowe z bazy Noise Stress Test Database
(NST-DB).

Koñcowym wynikiem dzia³ania modelu by³a jednowymiarowa mapa prawdopodobieñstwa,
podobna do tej generowanej przez model oparty na LSTM, przedstawiony wczeœniej.
Po odpowiednim przetworzeniu wyjœcia, model osi¹ga³ wyniki F1 na poziomie
przekraczaj¹cym 0.99, przewy¿szaj¹c inne metody porównane w badaniu.

\subsection{Przewidywanie poziomu elektrolitów we krwi}
Analiza sygna³u EKG dostarcza informacji nie tylko o pracy serca, ale tak¿e o
ogólnym stanie zdrowia pacjenta, w tym o poziomach elektrolitów i innych
substancji we krwi. Nowoczesne metody oparte na uczeniu maszynowym, zw³aszcza
g³êbokie sieci neuronowe (DNN), umo¿liwiaj¹ przewidywanie stê¿eñ elektrolitów,
takich jak potas, wapñ czy sód, oraz biomarkerów, takich jak kreatynina, na
podstawie danych EKG.

Temat ten by³ przedmiotem szczegó³owych badañ opisanych w pracy
\cite{Bachmann-electrolyte_prediction}, gdzie autorzy wykorzystali DNN oparty
na architekturze ResNet. Model regresji bezpoœredniej wytrenowano na ponad 290
000 nagraniach EKG powi¹zanych z wynikami badañ krwi, zebranych w szwedzkich
szpitalach. DNN osi¹gn¹³ lepsze wyniki ni¿ klasyczne metody uczenia
maszynowego, takie jak Random Forest czy Gradient Boost. Najlepsze wyniki
uzyskano dla potasu, z korelacj¹ Pearsona 0,58–0,60, natomiast dla wapnia i
sodu skutecznoœæ by³a ni¿sza, co mo¿e wynikaæ z subtelniejszych zmian w EKG i
wê¿szego zakresu wartoœci tych parametrów.

Mimo przewagi nad tradycyjnymi metodami uczenia maszynowego, model nie osi¹gn¹³
dok³adnoœci pozwalaj¹cej zast¹piæ badania laboratoryjne. Autorzy widz¹ jednak
potencja³ zastosowania w telemedycynie, szczególnie w karetkach lub odleg³ych
lokalizacjach bez dostêpu do analiz krwi.

% Analiza sygna³u EKG mo¿e dostarczyæ informacji nie tylko o pracy serca, ale
% równie¿ o ogólnym stanie zdrowia pacjenta, w tym o poziomie elektrolitów we
% krwi. Nowoczesne metody oparte na uczeniu maszynowym, w szczególnoœci g³êbokie
% sieci neuronowe, umo¿liwiaj¹ przewidywanie stê¿eñ takich elektrolitów jak
% potas, wapñ czy sód na podstawie danych EKG.

% Przyk³adem miar, które mog¹ byæ przewidywane na podstawie analizy wykresu EKG,
% jest stê¿enie elektrolitów we krwi, takich jak potas, wapñ czy sód, a tak¿e
% stê¿enie kreatyniny. Temat ten by³ przedmiotem szczegó³owych badañ opisanych w
% pracy \cite{Bachmann-electrolyte_prediction}, gdzie autorzy wykorzystali
% g³êbokie sieci neuronowe (DNN), opieraj¹c swoje rozwi¹zanie na architekturze
% ResNet.

% Model regresji bezpoœredniej wytrenowano na ponad 290 000 nagraniach EKG
% powi¹zanych z wynikami badañ krwi, zebranych w szwedzkich szpitalach. DNN
% osi¹gn¹³ lepsze wyniki ni¿ klasyczne metody uczenia maszynowego, takie jak
% Random Forest czy Gradient Boost. Najlepsze okaza³y sie wyniki dla potasu, z
% korelacj¹ Pearsona 0,58–0,60, niestety w przypadku innych elektrolitów, takich
% jak wapñ czy sód, skutecznoœæ by³a ni¿sza, co mo¿e wynikaæ z subtelniejszych
% zmian w EKG i wê¿szego zakresu wartoœci tych parametrów.

% Mimo przewagi nad tradycyjnymi metodami uczenia maszynowego, model nie osi¹gn¹³
% dok³adnoœci pozwalaj¹cej zast¹piæ badania laboratoryjne. Autorzy widz¹ jednak
% potencja³ zastosowania w telemedycynie, szczególnie w karetkach lub odleg³ych
% lokalizacjach bez dostêpu do analiz krwi.

\subsection{Wykrywanie COVID-19}
Pandemia COVID-19 wywo³a³a globalne wyzwania w diagnostyce i zarz¹dzaniu
zdrowiem publicznym. Tradycyjne metody diagnostyczne, takie jak testy PCR, choæ
dok³adne, s¹ czasoch³onne i wymagaj¹ dostêpu do zaawansowanej infrastruktury. W
odpowiedzi na te ograniczenia coraz wiêksze zainteresowanie budzi zastosowanie
metod uczenia maszynowego, które pozwalaj¹ na szybk¹ i skuteczn¹ analizê du¿ych
zbiorów danych medycznych.

Temat zastosowania uczenia maszynowego do diagnozy COVID-19 poruszyli autorzy
publikacji \cite{Irungu-EcgCovid}. Zastosowali oni takie algorytmy jak KNN
(K-Nearest Neighbors), SVM (Support Vector Machine) oraz las losowy (Random
Forest) do budowy modeli klasyfikacyjnych. Zastosowanie tych algorytmów
wymaga³o wczeœniejszego usuniêcia zak³óceñ z sygna³u i wyodrebnienia cech w
domenach takich jak czasowa, czestotliwosciowa czy czasowo-czestotliwosciowa.

Modele wykaza³y siê wysok¹ skutecznoœci¹ w wykrywaniu COVID-19, osi¹gaj¹c
dok³adnoœæ klasyfikacji na poziomie: 97.09\% dla Random Forest, 96.51\% dla SVM
oraz 95.34\% dla algorytmu KNN. Autorzy podkreœlili potencja³ wykorzystania
takich rozwi¹zañ w diagnostyce COVID-19 poza œrodowiskiem klinicznym,
szczególnie przy u¿yciu jednoodprowadzeniowych urz¹dzeñ noszonych do
monitorowania pracy serca.

Rozwi¹zanie typu end-to-end, niewymagaj¹ce wczeœniejszego wyodrebniania cech z
sygna³u EKG przedstawiono w pracy \cite{SAKR2023324}. Autorzy opracowali trzy
ró¿ne modele oparte na konwolucyjnych sieciach neuronowych (CNN) w celu oceny
ich wydajnoœci w klasyfikacji sygna³ów EKG i wybrali najbardziej obiecuj¹cy z
nich. Modele te pracowa³y w trybie end-to-end, co oznacza³o, ¿e obrazy EKG by³y
bezpoœrednio podawane do sieci bez koniecznoœci stosowania dodatkowych etapów
przetwarzania wstêpnego. Aby zapewniæ spójnoœæ danych wejœciowych, ka¿dy obraz
by³ przeskalowywany do rozmiaru 180x180 pikseli przed wprowadzeniem do sieci.

Pierwszy model sk³ada³ siê z czterech warstw splotowych, z których ka¿da by³a
zakoñczona operacj¹ max pooling. Po warstwach splotowych zastosowano warstwê
flatten, która przekszta³ca dane do jednowymiarowego wektora, oraz dwie warstwy
gêste, które realizowa³y klasyfikacjê. Drugi model zawiera³ szeœæ warstw
splotowych, przy czym pierwsza warstwa splotowa nie by³a po³¹czona z operacj¹
max pooling. W trzecim modelu równie¿ zastosowano szeœæ warstw splotowych,
jednak operacja max pooling by³a wykonywana dopiero od trzeciej warstwy.
Dodatkowo, po warstwie flatten zastosowano warstwê dropout, aby ograniczyæ
ryzyko nadmiernego dopasowania.

Najlepsze wyniki osi¹gn¹³ drugi model, uzyskuj¹c dok³adnoœæ, precyzjê, czu³oœæ
i wynik F1 na poziomie równym 98,81\% dla ka¿dej z wymienionych miar. Model ten
zosta³ oceniony równie¿ przy u¿yciu walidacji krzy¿owej na zbiorze
zniekszta³conym przez szum gaussowski, osi¹gaj¹c œredni¹ dok³adnoœæ 98,49\% w
5-fold cross-validation i 94,91\% w 10-fold cross-validation, co wskazuje na
niewielki wp³yw szumu na skutecznoœæ. Dziêki wysokiej efektywnoœci i odpornoœci
na zak³ócenia, drugi model zosta³ uznany za najbardziej obiecuj¹ce narzêdzie do
analizy sygna³ów EKG w diagnostyce COVID-19.

\subsection{Uczenie maszynowe w kontekscie HRV}
Miary HRV (Heart Rate Variability) stanowi¹ skuteczne narzêdzie do oceny pracy serca, poziomu stresu oraz ogólnego stanu zdrowia badanej osoby. Obliczane s¹ na podstawie uprzednio wyznaczonych odstêpów RR, z wykorzystaniem metod analizy czasowej oraz przekszta³ceñ z zakresu analizy czêstotliwoœciowej. Przegl¹d literatury wskazuje, ¿e trudno znaleŸæ dobrze udokumentowane badania, które precyzyjnie przewiduj¹ wartoœci miar HRV bezpoœrednio na podstawie sygna³u EKG przy u¿yciu algorytmów uczenia maszynowego, poniewa¿ podejœcie to wci¹¿ jest rzadko stosowane. Klasyczne metody obliczeniowe s¹ natomiast zdecydowanie dok³adne i niemal wy³¹cznie one znajduj¹ zastosowanie w analizie HRV.

Istniej¹ jednak prace, które w kontekœcie metod opartych na sztucznej inteligencji skutecznie wyznaczaj¹ miary HRV z innych sygna³ów, takich jak PPG (fotopletyzmografia), lub analizuj¹ zmiennoœæ rytmu serca na podstawie obrazów twarzy w podczerwieni. HRV, wyznaczane przewa¿nie za pomoc¹ klasycznych metod, odgrywa kluczow¹ rolê jako cecha wejœciowa w bardziej zaawansowanych analizach, takich jak diagnozowanie chorób serca czy ocena poziomu stresu. W takich zastosowaniach algorytmy uczenia maszynowego znajduj¹ szerokie zastosowanie, co podkreœla istotn¹ rolê HRV w interdyscyplinarnych badaniach oraz praktyce klinicznej.

Przytoczony wczeœniej przyk³ad, dotycz¹cy analizy obrazów w podczerwieni, zaczerpniêto z \cite{andrea-termo}. W badaniu zastosowano algorytm regresji wektorów noœnych (SVR) do przewidywania parametrów HRV na podstawie danych termowizyjnych twarzy. Analizie poddano zmiany temperatury skóry w kluczowych obszarach twarzy, takich jak glabella (obszar miêdzy brwiami), czubek nosa i nozdrza. Na podstawie tych danych wyodrêbniono cechy, takie jak entropia próbkowa (SampEn), odchylenie standardowe oraz gêstoœæ mocy widmowej (PSD) w ró¿nych zakresach czêstotliwoœci.

Algorytm umo¿liwi³ oszacowanie wa¿nych miar HRV, takich jak RMSSD, SDNN, pNN50, LF/HF, odstêpy RR oraz œrednie têtno (HR). Wyniki pokaza³y, ¿e model dobrze przewidywa³ parametry HR, RR, TINN i pNN50, osi¹gaj¹c wysok¹ zgodnoœæ z rzeczywistymi wartoœciami (korelacje r > 0,7). Dla miar takich jak RMSSD, SDNN i LF/HF uzyskano umiarkowan¹ dok³adnoœæ (r miêdzy 0,44 a 0,58).

Badanie wykaza³o, ¿e uczenie maszynowe mo¿e skutecznie analizowaæ niektóre metryki HRV na podstawie danych termowizyjnych. Jego zastosowanie mo¿e byæ szczególnie przydatne w warunkach, gdzie tradycyjne metody pomiaru s¹ trudne do zastosowania, takich jak s³abe oœwietlenie.




\subsection{Uczenie maszynowe w kontekscie RSA}

